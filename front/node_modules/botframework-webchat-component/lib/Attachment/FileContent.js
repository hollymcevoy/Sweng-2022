"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _botframeworkWebchatApi = require("botframework-webchat-api");

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _DownloadIcon = _interopRequireDefault(require("./Assets/DownloadIcon"));

var _useStyleSet3 = _interopRequireDefault(require("../hooks/useStyleSet"));

var _useStyleToEmotionObject = _interopRequireDefault(require("../hooks/internal/useStyleToEmotionObject"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var useByteFormatter = _botframeworkWebchatApi.hooks.useByteFormatter,
    useDirection = _botframeworkWebchatApi.hooks.useDirection,
    useLocalizer = _botframeworkWebchatApi.hooks.useLocalizer;
var ROOT_STYLE = {
  display: 'flex',
  '& .webchat__fileContent__buttonLink': {
    display: 'flex',
    flex: 1
  },
  '& .webchat__fileContent__badge': {
    display: 'flex',
    flex: 1,
    flexDirection: 'column'
  }
};
var ALLOWED_PROTOCOLS = ['data:', 'http:', 'https:'];

function isAllowedProtocol(url) {
  try {
    return ALLOWED_PROTOCOLS.includes(new URL(url).protocol);
  } catch (err) {
    return false;
  }
}

var FileContentBadge = function FileContentBadge(_ref) {
  var downloadIcon = _ref.downloadIcon,
      fileName = _ref.fileName,
      size = _ref.size;

  var _useDirection = useDirection(),
      _useDirection2 = _slicedToArray(_useDirection, 1),
      direction = _useDirection2[0];

  var formatByte = useByteFormatter();
  var localizedSize = typeof size === 'number' && formatByte(size);
  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement("div", {
    "aria-hidden": true,
    className: "webchat__fileContent__badge"
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__fileContent__fileName"
  }, fileName), !!localizedSize && /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__fileContent__size"
  }, localizedSize)), downloadIcon && /*#__PURE__*/_react.default.createElement(_DownloadIcon.default, {
    className: (0, _classnames.default)('webchat__fileContent__downloadIcon', direction === 'rtl' && 'webchat__fileContent__downloadIcon--rtl'),
    size: 1.5
  }));
};

FileContentBadge.defaultProps = {
  downloadIcon: false,
  size: undefined
};
FileContentBadge.propTypes = {
  downloadIcon: _propTypes.default.bool,
  fileName: _propTypes.default.string.isRequired,
  size: _propTypes.default.number
};

var FileContent = function FileContent(_ref2) {
  var className = _ref2.className,
      href = _ref2.href,
      fileName = _ref2.fileName,
      size = _ref2.size;

  var _useStyleSet = (0, _useStyleSet3.default)(),
      _useStyleSet2 = _slicedToArray(_useStyleSet, 1),
      fileContentStyleSet = _useStyleSet2[0].fileContent;

  var localize = useLocalizer();
  var localizeBytes = useByteFormatter();
  var rootClassName = (0, _useStyleToEmotionObject.default)()(ROOT_STYLE) + '';
  var localizedSize = typeof size === 'number' && localizeBytes(size);
  href = href && isAllowedProtocol(href) ? href : undefined;
  var alt = localize(href ? localizedSize ? 'FILE_CONTENT_DOWNLOADABLE_WITH_SIZE_ALT' : 'FILE_CONTENT_DOWNLOADABLE_ALT' : localizedSize ? 'FILE_CONTENT_WITH_SIZE_ALT' : 'FILE_CONTENT_ALT', fileName, localizedSize);
  return /*#__PURE__*/_react.default.createElement("div", {
    className: (0, _classnames.default)('webchat__fileContent', rootClassName, fileContentStyleSet + '', (className || '') + '')
  }, href ? /*#__PURE__*/_react.default.createElement("a", {
    "aria-label": alt,
    className: "webchat__fileContent__buttonLink",
    download: fileName,
    href: href,
    rel: "noopener noreferrer",
    target: "_blank"
  }, /*#__PURE__*/_react.default.createElement(FileContentBadge, {
    downloadIcon: true,
    fileName: fileName,
    size: size
  })) : /*#__PURE__*/_react.default.createElement(FileContentBadge, {
    downloadIcon: false,
    fileName: fileName,
    size: size
  }));
};

FileContent.defaultProps = {
  className: '',
  href: undefined,
  size: undefined
};
FileContent.propTypes = {
  className: _propTypes.default.string,
  fileName: _propTypes.default.string.isRequired,
  href: _propTypes.default.string,
  size: _propTypes.default.number
};
var _default = FileContent;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9BdHRhY2htZW50L0ZpbGVDb250ZW50LnRzeCJdLCJuYW1lcyI6WyJ1c2VCeXRlRm9ybWF0dGVyIiwiaG9va3MiLCJ1c2VEaXJlY3Rpb24iLCJ1c2VMb2NhbGl6ZXIiLCJST09UX1NUWUxFIiwiZGlzcGxheSIsImZsZXgiLCJmbGV4RGlyZWN0aW9uIiwiQUxMT1dFRF9QUk9UT0NPTFMiLCJpc0FsbG93ZWRQcm90b2NvbCIsInVybCIsImluY2x1ZGVzIiwiVVJMIiwicHJvdG9jb2wiLCJlcnIiLCJGaWxlQ29udGVudEJhZGdlIiwiZG93bmxvYWRJY29uIiwiZmlsZU5hbWUiLCJzaXplIiwiZGlyZWN0aW9uIiwiZm9ybWF0Qnl0ZSIsImxvY2FsaXplZFNpemUiLCJkZWZhdWx0UHJvcHMiLCJ1bmRlZmluZWQiLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJib29sIiwic3RyaW5nIiwiaXNSZXF1aXJlZCIsIm51bWJlciIsIkZpbGVDb250ZW50IiwiY2xhc3NOYW1lIiwiaHJlZiIsImZpbGVDb250ZW50U3R5bGVTZXQiLCJmaWxlQ29udGVudCIsImxvY2FsaXplIiwibG9jYWxpemVCeXRlcyIsInJvb3RDbGFzc05hbWUiLCJhbHQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7OztBQUVBLElBQVFBLGdCQUFSLEdBQXlEQyw2QkFBekQsQ0FBUUQsZ0JBQVI7QUFBQSxJQUEwQkUsWUFBMUIsR0FBeURELDZCQUF6RCxDQUEwQkMsWUFBMUI7QUFBQSxJQUF3Q0MsWUFBeEMsR0FBeURGLDZCQUF6RCxDQUF3Q0UsWUFBeEM7QUFFQSxJQUFNQyxVQUFVLEdBQUc7QUFDakJDLEVBQUFBLE9BQU8sRUFBRSxNQURRO0FBR2pCLHlDQUF1QztBQUNyQ0EsSUFBQUEsT0FBTyxFQUFFLE1BRDRCO0FBRXJDQyxJQUFBQSxJQUFJLEVBQUU7QUFGK0IsR0FIdEI7QUFRakIsb0NB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QUVPLG1CQUFVSTtBQUpNLENBQXhCO2VBT2VDLFciLCJzb3VyY2VSb290IjoiY29tcG9uZW50Oi8vLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGhvb2tzIH0gZnJvbSAnYm90ZnJhbWV3b3JrLXdlYmNoYXQtYXBpJztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBSZWFjdCwgeyBGQyB9IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IERvd25sb2FkSWNvbiBmcm9tICcuL0Fzc2V0cy9Eb3dubG9hZEljb24nO1xuaW1wb3J0IHVzZVN0eWxlU2V0IGZyb20gJy4uL2hvb2tzL3VzZVN0eWxlU2V0JztcbmltcG9ydCB1c2VTdHlsZVRvRW1vdGlvbk9iamVjdCBmcm9tICcuLi9ob29rcy9pbnRlcm5hbC91c2VTdHlsZVRvRW1vdGlvbk9iamVjdCc7XG5cbmNvbnN0IHsgdXNlQnl0ZUZvcm1hdHRlciwgdXNlRGlyZWN0aW9uLCB1c2VMb2NhbGl6ZXIgfSA9IGhvb2tzO1xuXG5jb25zdCBST09UX1NUWUxFID0ge1xuICBkaXNwbGF5OiAnZmxleCcsXG5cbiAgJyYgLndlYmNoYXRfX2ZpbGVDb250ZW50X19idXR0b25MaW5rJzoge1xuICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICBmbGV4OiAxXG4gIH0sXG5cbiAgJyYgLndlYmNoYXRfX2ZpbGVDb250ZW50X19iYWRnZSc6IHtcbiAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgZmxleDogMSxcbiAgICBmbGV4RGlyZWN0aW9uOiAnY29sdW1uJ1xuICB9XG59O1xuXG5jb25zdCBBTExPV0VEX1BST1RPQ09MUyA9IFsnZGF0YTonLCAnaHR0cDonLCAnaHR0cHM6J107XG5cbmZ1bmN0aW9uIGlzQWxsb3dlZFByb3RvY29sKHVybCkge1xuICB0cnkge1xuICAgIHJldHVybiBBTExPV0VEX1BST1RPQ09MUy5pbmNsdWRlcyhuZXcgVVJMKHVybCkucHJvdG9jb2wpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuY29uc3QgRmlsZUNvbnRlbnRCYWRnZSA9ICh7IGRvd25sb2FkSWNvbiwgZmlsZU5hbWUsIHNpemUgfSkgPT4ge1xuICBjb25zdCBbZGlyZWN0aW9uXSA9IHVzZURpcmVjdGlvbigpO1xuICBjb25zdCBmb3JtYXRCeXRlID0gdXNlQnl0ZUZvcm1hdHRlcigpO1xuXG4gIGNvbnN0IGxvY2FsaXplZFNpemUgPSB0eXBlb2Ygc2l6ZSA9PT0gJ251bWJlcicgJiYgZm9ybWF0Qnl0ZShzaXplKTtcblxuICByZXR1cm4gKFxuICAgIDxSZWFjdC5GcmFnbWVudD5cbiAgICAgIDxkaXYgYXJpYS1oaWRkZW49e3RydWV9IGNsYXNzTmFtZT1cIndlYmNoYXRfX2ZpbGVDb250ZW50X19iYWRnZVwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndlYmNoYXRfX2ZpbGVDb250ZW50X19maWxlTmFtZVwiPntmaWxlTmFtZX08L2Rpdj5cbiAgICAgICAgeyEhbG9jYWxpemVkU2l6ZSAmJiA8ZGl2IGNsYXNzTmFtZT1cIndlYmNoYXRfX2ZpbGVDb250ZW50X19zaXplXCI+e2xvY2FsaXplZFNpemV9PC9kaXY+fVxuICAgICAgPC9kaXY+XG4gICAgICB7ZG93bmxvYWRJY29uICYmIChcbiAgICAgICAgPERvd25sb2FkSWNvblxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcyhcbiAgICAgICAgICAgICd3ZWJjaGF0X19maWxlQ29udGVudF9fZG93bmxvYWRJY29uJyxcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3J0bCcgJiYgJ3dlYmNoYXRfX2ZpbGVDb250ZW50X19kb3dubG9hZEljb24tLXJ0bCdcbiAgICAgICAgICApfVxuICAgICAgICAgIHNpemU9ezEuNX1cbiAgICAgICAgLz5cbiAgICAgICl9XG4gICAgPC9SZWFjdC5GcmFnbWVudD5cbiAgKTtcbn07XG5cbkZpbGVDb250ZW50QmFkZ2UuZGVmYXVsdFByb3BzID0ge1xuICBkb3dubG9hZEljb246IGZhbHNlLFxuICBzaXplOiB1bmRlZmluZWRcbn07XG5cbkZpbGVDb250ZW50QmFkZ2UucHJvcFR5cGVzID0ge1xuICBkb3dubG9hZEljb246IFByb3BUeXBlcy5ib29sLFxuICBmaWxlTmFtZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICBzaXplOiBQcm9wVHlwZXMubnVtYmVyXG59O1xuXG50eXBlIEZpbGVDb250ZW50UHJvcHMgPSB7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgZmlsZU5hbWU6IHN0cmluZztcbiAgaHJlZj86IHN0cmluZztcbiAgc2l6ZT86IG51bWJlcjtcbn07XG5cbmNvbnN0IEZpbGVDb250ZW50OiBGQzxGaWxlQ29udGVudFByb3BzPiA9ICh7IGNsYXNzTmFtZSwgaHJlZiwgZmlsZU5hbWUsIHNpemUgfSkgPT4ge1xuICBjb25zdCBbeyBmaWxlQ29udGVudDogZmlsZUNvbnRlbnRTdHlsZVNldCB9XSA9IHVzZVN0eWxlU2V0KCk7XG4gIGNvbnN0IGxvY2FsaXplID0gdXNlTG9jYWxpemVyKCk7XG4gIGNvbnN0IGxvY2FsaXplQnl0ZXMgPSB1c2VCeXRlRm9ybWF0dGVyKCk7XG4gIGNvbnN0IHJvb3RDbGFzc05hbWUgPSB1c2VTdHlsZVRvRW1vdGlvbk9iamVjdCgpKFJPT1RfU1RZTEUpICsgJyc7XG5cbiAgY29uc3QgbG9jYWxpemVkU2l6ZSA9IHR5cGVvZiBzaXplID09PSAnbnVtYmVyJyAmJiBsb2NhbGl6ZUJ5dGVzKHNpemUpO1xuXG4gIGhyZWYgPSBocmVmICYmIGlzQWxsb3dlZFByb3RvY29sKGhyZWYpID8gaHJlZiA6IHVuZGVmaW5lZDtcblxuICBjb25zdCBhbHQgPSBsb2NhbGl6ZShcbiAgICBocmVmXG4gICAgICA/IGxvY2FsaXplZFNpemVcbiAgICAgICAgPyAnRklMRV9DT05URU5UX0RPV05MT0FEQUJMRV9XSVRIX1NJWkVfQUxUJ1xuICAgICAgICA6ICdGSUxFX0NPTlRFTlRfRE9XTkxPQURBQkxFX0FMVCdcbiAgICAgIDogbG9jYWxpemVkU2l6ZVxuICAgICAgPyAnRklMRV9DT05URU5UX1dJVEhfU0laRV9BTFQnXG4gICAgICA6ICdGSUxFX0NPTlRFTlRfQUxUJyxcbiAgICBmaWxlTmFtZSxcbiAgICBsb2NhbGl6ZWRTaXplXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoJ3dlYmNoYXRfX2ZpbGVDb250ZW50Jywgcm9vdENsYXNzTmFtZSwgZmlsZUNvbnRlbnRTdHlsZVNldCArICcnLCAoY2xhc3NOYW1lIHx8ICcnKSArICcnKX1cbiAgICA+XG4gICAgICB7aHJlZiA/IChcbiAgICAgICAgPGFcbiAgICAgICAgICBhcmlhLWxhYmVsPXthbHR9XG4gICAgICAgICAgY2xhc3NOYW1lPVwid2ViY2hhdF9fZmlsZUNvbnRlbnRfX2J1dHRvbkxpbmtcIlxuICAgICAgICAgIGRvd25sb2FkPXtmaWxlTmFtZX1cbiAgICAgICAgICBocmVmPXtocmVmfVxuICAgICAgICAgIHJlbD1cIm5vb3BlbmVyIG5vcmVmZXJyZXJcIlxuICAgICAgICAgIHRhcmdldD1cIl9ibGFua1wiXG4gICAgICAgID5cbiAgICAgICAgICA8RmlsZUNvbnRlbnRCYWRnZSBkb3dubG9hZEljb249e3RydWV9IGZpbGVOYW1lPXtmaWxlTmFtZX0gc2l6ZT17c2l6ZX0gLz5cbiAgICAgICAgPC9hPlxuICAgICAgKSA6IChcbiAgICAgICAgPEZpbGVDb250ZW50QmFkZ2UgZG93bmxvYWRJY29uPXtmYWxzZX0gZmlsZU5hbWU9e2ZpbGVOYW1lfSBzaXplPXtzaXplfSAvPlxuICAgICAgKX1cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG5cbkZpbGVDb250ZW50LmRlZmF1bHRQcm9wcyA9IHtcbiAgY2xhc3NOYW1lOiAnJyxcbiAgaHJlZjogdW5kZWZpbmVkLFxuICBzaXplOiB1bmRlZmluZWRcbn07XG5cbkZpbGVDb250ZW50LnByb3BUeXBlcyA9IHtcbiAgY2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBmaWxlTmFtZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICBocmVmOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBzaXplOiBQcm9wVHlwZXMubnVtYmVyXG59O1xuXG5leHBvcnQgZGVmYXVsdCBGaWxlQ29udGVudDtcbiJdfQ==